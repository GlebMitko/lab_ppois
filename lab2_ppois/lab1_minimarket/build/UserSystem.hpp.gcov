        -:    0:Source:/Users/glebmitko/Desktop/lab1_minimarket/src/users/../../include/users/UserSystem.hpp
        -:    0:Graph:CMakeFiles/run_tests.dir/src/users/UserSystem.cpp.gcno
        -:    0:Data:CMakeFiles/run_tests.dir/src/users/UserSystem.cpp.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:#pragma once
        -:    2:#include <string>
        -:    3:#include <vector>
        -:    4:#include <memory>
        -:    5:#include <map>
        -:    6:#include <ctime>
        -:    7:#include "../utils/Exceptions.hpp"
        -:    8:
        -:    9:namespace minimarket {
        -:   10:namespace users {
        -:   11:
        -:   12:// 1. Базовый класс пользователя
        -:   13:class User {
        -:   14:private:
        -:   15:    std::string userId;
        -:   16:    std::string username;
        -:   17:    std::string email;
        -:   18:public:
        -:   19:    User(const std::string& id, const std::string& name, const std::string& userEmail);
        -:   20:    
        -:   21:    // Добавляем геттеры
        -:   22:    std::string getUserId() const { return userId; }
        -:   23:    std::string getUsername() const { return username; }
        -:   24:    std::string getEmail() const { return email; }
        -:   25:    
        -:   26:    virtual bool authenticate(const std::string& password) const;
        -:   27:    virtual std::string getUserRole() const;
        -:   28:    bool updateEmail(const std::string& newEmail);
        -:   29:};
        -:   30:
        -:   31:// 2. Клиент банка
        -:   32:class Customer : public User {
        -:   33:private:
        -:   34:    std::string customerId;
        -:   35:    std::string phoneNumber;
        -:   36:    std::time_t registrationDate;
        -:   37:public:
        -:   38:    Customer(const std::string& id, const std::string& name,
        -:   39:             const std::string& email, const std::string& phone);
        -:   40:    
        -:   41:    // Добавляем геттеры
        -:   42:    std::string getCustomerId() const { return customerId; }
        -:   43:    std::string getPhoneNumber() const { return phoneNumber; }
        -:   44:    
        -:   45:    bool validatePhoneNumber() const;
        -:   46:    int calculateLoyaltyYears() const;
        -:   47:    bool canApplyForPremium() const;
        -:   48:};
        -:   49:
        -:   50:// 3. Сотрудник банка
        -:   51:class Employee : public User {
        -:   52:private:
        -:   53:    std::string employeeId;
        -:   54:    std::string department;
        -:   55:    double salary;
        -:   56:public:
        -:   57:    Employee(const std::string& id, const std::string& name,
        -:   58:             const std::string& email, const std::string& dept, double sal);
        -:   59:    
        -:   60:    // Добавляем геттеры
        -:   61:    std::string getEmployeeId() const { return employeeId; }
        -:   62:    std::string getDepartment() const { return department; }
        -:   63:    double getSalary() const { return salary; }
        -:   64:    
        -:   65:    bool approveLoanApplication(double amount) const;
        -:   66:    double calculateAnnualBonus() const;
        -:   67:    bool canAccessSensitiveData() const;
        -:   68:};
        -:   69:
        -:   70:// 4. Администратор системы
        -:   71:class Admin : public User {
        -:   72:private:
        -:   73:    std::string adminLevel;
        -:   74:    std::vector<std::string> permissions;
        -:   75:public:
        -:   76:    Admin(const std::string& id, const std::string& name,
        -:   77:          const std::string& email, const std::string& level);
        -:   78:    
        -:   79:    // Добавляем геттеры
        -:   80:    std::string getAdminLevel() const { return adminLevel; }
        -:   81:    
        -:   82:    bool grantPermissions(const std::string& permission);
        -:   83:    bool revokeUserAccess(const std::string& targetUserId);
        -:   84:    bool canModifySystemSettings() const;
        -:   85:};
        -:   86:
        -:   87:// 5. Профиль пользователя
        -:   88:class UserProfile {
        -:   89:private:
        -:   90:    std::string userId;
        -:   91:    std::string firstName;
        -:   92:    std::string lastName;
        -:   93:    std::string dateOfBirth;
        -:   94:public:
        -:   95:    UserProfile(const std::string& id, const std::string& first,
        -:   96:                const std::string& last, const std::string& dob);
        -:   97:    
        -:   98:    // Добавляем геттеры
        -:   99:    std::string getUserId() const { return userId; }
        -:  100:    std::string getFirstName() const { return firstName; }
        -:  101:    std::string getLastName() const { return lastName; }
        -:  102:    std::string getDateOfBirth() const { return dateOfBirth; }
        -:  103:    
        -:  104:    int calculateAge() const;
        -:  105:    std::string getFullName() const;
        -:  106:    bool isAdult() const;
        -:  107:};
        -:  108:
        -:  109:// 6. Адрес пользователя
        -:  110:class Address {
        -:  111:private:
        -:  112:    std::string street;
        -:  113:    std::string city;
        -:  114:    std::string postalCode;
        -:  115:    std::string country;
        -:  116:public:
        -:  117:    Address(const std::string& st, const std::string& ct,
        -:  118:            const std::string& postal, const std::string& cntry);
        -:  119:    
        -:  120:    // Добавляем геттеры
        -:  121:    std::string getStreet() const { return street; }
        -:  122:    std::string getCity() const { return city; }
        -:  123:    std::string getPostalCode() const { return postalCode; }
        -:  124:    std::string getCountry() const { return country; }
        -:  125:    
        -:  126:    bool validateAddress() const;
        -:  127:    std::string getFormattedAddress() const;
        -:  128:    bool isInternational() const;
        -:  129:};
        -:  130:
        -:  131:// 7. Контактная информация
        -:  132:class ContactInfo {
        -:  133:private:
        -:  134:    std::string phoneNumber;
        -:  135:    std::string email;
        -:  136:    std::string emergencyContact;
        -:  137:public:
        -:  138:    ContactInfo(const std::string& phone, const std::string& mail,
        -:  139:                const std::string& emergency);
        -:  140:    
        -:  141:    // Добавляем геттеры
        -:  142:    std::string getPhoneNumber() const { return phoneNumber; }
        -:  143:    std::string getEmail() const { return email; }
        -:  144:    std::string getEmergencyContact() const { return emergencyContact; }
        -:  145:    
        -:  146:    bool validateContactInfo() const;
        -:  147:    std::string getPrimaryContact() const;
        -:  148:    bool hasEmergencyContact() const;
        -:  149:};
        -:  150:
        -:  151:// 8. Учетные данные для входа
        -:  152:class LoginCredentials {
        -:  153:private:
        -:  154:    std::string username;
        -:  155:    std::string passwordHash;
        -:  156:    std::time_t lastLogin;
        -:  157:public:
        -:  158:    LoginCredentials(const std::string& user, const std::string& password);
        -:  159:    
        -:  160:    // Добавляем геттеры
        -:  161:    std::string getUsername() const { return username; }
        -:  162:    std::time_t getLastLogin() const { return lastLogin; }
        -:  163:    
        -:  164:    bool verifyPassword(const std::string& inputPassword) const;
        -:  165:    void updatePassword(const std::string& newPassword);
        -:  166:    bool isPasswordExpired() const;
        -:  167:};
        -:  168:
        -:  169:// 9. Сессия пользователя
        -:  170:class UserSession {
        -:  171:private:
        -:  172:    std::string sessionId;
        -:  173:    std::string userId;
        -:  174:    std::time_t startTime;
        -:  175:    std::time_t lastActivity;
        -:  176:public:
        -:  177:    UserSession(const std::string& sessId, const std::string& uid);
        -:  178:    
        -:  179:    // Добавляем геттеры
        -:  180:    std::string getSessionId() const { return sessionId; }
        -:  181:    std::string getUserId() const { return userId; }
        -:  182:    std::time_t getStartTime() const { return startTime; }
        -:  183:    std::time_t getLastActivity() const { return lastActivity; }
        -:  184:    
        -:  185:    bool isSessionValid() const;
        -:  186:    void refreshSession();
        -:  187:    int calculateSessionDuration() const;
        -:  188:};
        -:  189:
        -:  190:// 10. Настройки пользователя
        -:  191:class UserPreferences {
        -:  192:private:
        -:  193:    std::string userId;
        -:  194:    std::map<std::string, std::string> preferences;
        -:  195:    std::string language;
        -:  196:public:
        -:  197:    UserPreferences(const std::string& uid, const std::string& lang = "en");
        -:  198:    
        -:  199:    // Добавляем геттеры
        -:  200:    std::string getUserId() const { return userId; }
        -:  201:    std::string getLanguage() const { return language; }
        -:  202:    
        -:  203:    bool setPreference(const std::string& key, const std::string& value);
        -:  204:    std::string getPreference(const std::string& key) const;
        -:  205:    bool supportsLanguage(const std::string& lang) const;
        -:  206:};
        -:  207:
        -:  208:} // namespace users
        -:  209:} // namespace minimarket
