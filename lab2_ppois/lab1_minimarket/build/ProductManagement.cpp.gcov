        -:    0:Source:/Users/glebmitko/Desktop/lab1_minimarket/src/products/ProductManagement.cpp
        -:    0:Graph:CMakeFiles/run_tests.dir/src/products/ProductManagement.cpp.gcno
        -:    0:Data:CMakeFiles/run_tests.dir/src/products/ProductManagement.cpp.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:#include "../../include/products/ProductManagement.hpp"
        -:    2:#include "../../include/utils/Exceptions.hpp"
        -:    3:#include <algorithm>
        -:    4:#include <cmath>
        -:    5:
        -:    6:namespace minimarket {
        -:    7:namespace products {
        -:    8:
        -:    9:// 1. Product implementation
function _ZN10minimarket8products7ProductC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_d called 9 returned 100% blocks executed 73%
function _ZN10minimarket8products7ProductC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_d called 9 returned 100% blocks executed 100%
       18:   10:Product::Product(const std::string& id, const std::string& name, double price)
       18:   11:    : productId(id), productName(name), basePrice(price) {
branch  0 taken 100%
branch  1 taken 0%
        9:   12:    if (price < 0) throw exceptions::InvalidOperationException("Price cannot be negative");
branch  0 taken 89%
branch  1 taken 11%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 100%
branch  5 taken 0%
branch  6 taken 0%
branch  7 taken 100%
branch  8 taken 0%
branch  9 taken 100%
       19:   13:}
        -:   14:
function _ZNK10minimarket8products7Product19calculateFinalPriceEv called 7 returned 100% blocks executed 100%
        7:   15:double Product::calculateFinalPrice() const {
        7:   16:    return basePrice * 1.2; // 20% налог
        -:   17:}
        -:   18:
function _ZN10minimarket8products7Product13applyDiscountEd called 3 returned 100% blocks executed 100%
        3:   19:bool Product::applyDiscount(double discountPercent) {
        3:   20:    if (discountPercent < 0 || discountPercent > 100) return false;
branch  0 taken 67%
branch  1 taken 33%
branch  2 taken 50%
branch  3 taken 50%
        1:   21:    basePrice *= (1 - discountPercent / 100);
        1:   22:    return true;
        3:   23:}
        -:   24:
function _ZNK10minimarket8products7Product14getProductInfoEv called 3 returned 100% blocks executed 38%
        3:   25:std::string Product::getProductInfo() const {
        3:   26:    return productName + " (ID: " + productId + ") - $" + std::to_string(basePrice);
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 100%
branch  5 taken 0%
branch  6 taken 0%
branch  7 taken 100%
    #####:   27:}
        -:   28:
        -:   29:// 2. Category implementation
function _ZN10minimarket8products8CategoryC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 4 returned 100% blocks executed 50%
function _ZN10minimarket8products8CategoryC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 4 returned 100% blocks executed 100%
        8:   30:Category::Category(const std::string& id, const std::string& name)
        8:   31:    : categoryId(id), categoryName(name) {}
branch  0 taken 100%
branch  1 taken 0%
        -:   32:
function _ZN10minimarket8products8Category10addProductERKNSt3__110shared_ptrINS0_7ProductEEE called 6 returned 100% blocks executed 75%
        6:   33:bool Category::addProduct(const std::shared_ptr<Product>& product) {
        6:   34:    if (!product) return false;
branch  0 taken 0%
branch  1 taken 100%
        6:   35:    products.push_back(product);
        6:   36:    return true;
        6:   37:}
        -:   38:
function _ZNK10minimarket8products8Category24calculateCategoryRevenueEv called 4 returned 100% blocks executed 100%
        4:   39:double Category::calculateCategoryRevenue() const {
        4:   40:    double total = 0.0;
       10:   41:    for (const auto& product : products) {
branch  0 taken 60%
branch  1 taken 40%
        6:   42:        total += product->calculateFinalPrice();
        -:   43:    }
        4:   44:    return total;
        -:   45:}
        -:   46:
function _ZNK10minimarket8products8Category15getProductNamesEv called 2 returned 100% blocks executed 61%
        2:   47:std::vector<std::string> Category::getProductNames() const {
        2:   48:    std::vector<std::string> names;
        4:   49:    for (const auto& product : products) {
branch  0 taken 50%
branch  1 taken 50%
        2:   50:        names.push_back(product->getProductInfo());
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
        -:   51:    }
        2:   52:    return names;
        2:   53:}
branch  0 taken 100%
branch  1 taken 0%
        -:   54:
        -:   55:// 3. Inventory implementation
function _ZN10minimarket8products9InventoryC2Ei called 3 returned 100% blocks executed 100%
function _ZN10minimarket8products9InventoryC1Ei called 3 returned 100% blocks executed 100%
        6:   56:Inventory::Inventory(int threshold) : lowStockThreshold(threshold) {}
        -:   57:
function _ZN10minimarket8products9Inventory11updateStockERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEEi called 8 returned 100% blocks executed 75%
        8:   58:bool Inventory::updateStock(const std::string& productId, int quantity) {
        8:   59:    if (productId.empty()) return false;
branch  0 taken 0%
branch  1 taken 100%
        8:   60:    stockLevels[productId] += quantity;
        8:   61:    return true;
        8:   62:}
        -:   63:
function _ZNK10minimarket8products9Inventory17checkAvailabilityERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEEi called 3 returned 100% blocks executed 100%
        3:   64:bool Inventory::checkAvailability(const std::string& productId, int requested) const {
        3:   65:    auto it = stockLevels.find(productId);
        3:   66:    if (it == stockLevels.end()) return false;
branch  0 taken 33%
branch  1 taken 67%
        2:   67:    return it->second >= requested;
        3:   68:}
        -:   69:
function _ZNK10minimarket8products9Inventory19getLowStockProductsEv called 3 returned 100% blocks executed 80%
        3:   70:std::vector<std::string> Inventory::getLowStockProducts() const {
        3:   71:    std::vector<std::string> lowStock;
       11:   72:    for (const auto& [productId, quantity] : stockLevels) {
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 73%
branch  3 taken 27%
branch  4 taken 100%
branch  5 taken 0%
branch  6 taken 100%
branch  7 taken 0%
        8:   73:        if (quantity <= lowStockThreshold) {
branch  0 taken 63%
branch  1 taken 38%
        5:   74:            lowStock.push_back(productId);
branch  0 taken 100%
branch  1 taken 0%
        5:   75:        }
        -:   76:    }
        3:   77:    return lowStock;
        3:   78:}
branch  0 taken 100%
branch  1 taken 0%
        -:   79:
        -:   80:// 4. PricingStrategy implementation
function _ZN10minimarket8products15PricingStrategyC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEEd called 1 returned 100% blocks executed 100%
function _ZN10minimarket8products15PricingStrategyC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEEd called 1 returned 100% blocks executed 100%
        2:   81:PricingStrategy::PricingStrategy(const std::string& type, double markup)
        2:   82:    : strategyType(type), markupPercentage(markup) {}
        -:   83:
function _ZNK10minimarket8products15PricingStrategy12applyPricingEd called 1 returned 100% blocks executed 100%
        1:   84:double PricingStrategy::applyPricing(double costPrice) const {
        1:   85:    return costPrice * (1 + markupPercentage / 100);
        -:   86:}
        -:   87:
function _ZNK10minimarket8products15PricingStrategy15validatePricingEdd called 3 returned 100% blocks executed 100%
        3:   88:bool PricingStrategy::validatePricing(double cost, double selling) const {
        3:   89:    return selling >= cost && selling <= cost * 3; // Максимум 300% наценки
branch  0 taken 33%
branch  1 taken 67%
        -:   90:}
        -:   91:
        -:   92:// 5. DiscountSystem implementation
function _ZN10minimarket8products14DiscountSystemC2Ed called 2 returned 100% blocks executed 100%
function _ZN10minimarket8products14DiscountSystemC1Ed called 2 returned 100% blocks executed 100%
        4:   93:DiscountSystem::DiscountSystem(double loyaltyRate) : loyaltyDiscountRate(loyaltyRate) {}
        -:   94:
function _ZN10minimarket8products14DiscountSystem20applyProductDiscountERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEEd called 3 returned 100% blocks executed 100%
        3:   95:bool DiscountSystem::applyProductDiscount(const std::string& productId, double discount) {
        3:   96:    if (discount < 0 || discount > 50) return false; // Максимум 50% скидка
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 33%
branch  3 taken 67%
        2:   97:    activeDiscounts[productId] = discount;
        2:   98:    return true;
        3:   99:}
        -:  100:
function _ZNK10minimarket8products14DiscountSystem24calculateLoyaltyDiscountEd called 1 returned 100% blocks executed 100%
        1:  101:double DiscountSystem::calculateLoyaltyDiscount(double totalAmount) const {
        1:  102:    return totalAmount * (loyaltyDiscountRate / 100);
        -:  103:}
        -:  104:
function _ZNK10minimarket8products14DiscountSystem15isDiscountValidERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 3 returned 100% blocks executed 100%
        3:  105:bool DiscountSystem::isDiscountValid(const std::string& productId) const {
        3:  106:    auto it = activeDiscounts.find(productId);
        3:  107:    return it != activeDiscounts.end() && it->second > 0;
branch  0 taken 33%
branch  1 taken 67%
        -:  108:}
        -:  109:
        -:  110:// 6. Supplier implementation
function _ZN10minimarket8products8SupplierC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 1 returned 100% blocks executed 50%
function _ZN10minimarket8products8SupplierC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 1 returned 100% blocks executed 100%
        2:  111:Supplier::Supplier(const std::string& id, const std::string& name)
        2:  112:    : supplierId(id), supplierName(name) {}
branch  0 taken 100%
branch  1 taken 0%
        -:  113:
function _ZN10minimarket8products8Supplier18addSuppliedProductERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 3 returned 100% blocks executed 100%
        3:  114:bool Supplier::addSuppliedProduct(const std::string& productId) {
        3:  115:    if (productId.empty()) return false;
branch  0 taken 33%
branch  1 taken 67%
        2:  116:    suppliedProducts.push_back(productId);
        2:  117:    return true;
        3:  118:}
        -:  119:
function _ZNK10minimarket8products8Supplier16canSupplyProductERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 2 returned 100% blocks executed 100%
        2:  120:bool Supplier::canSupplyProduct(const std::string& productId) const {
        2:  121:    return std::find(suppliedProducts.begin(), suppliedProducts.end(), productId) != suppliedProducts.end();
        -:  122:}
        -:  123:
function _ZNK10minimarket8products8Supplier24getSuppliedProductsCountEv called 1 returned 100% blocks executed 100%
        1:  124:int Supplier::getSuppliedProductsCount() const {
        1:  125:    return suppliedProducts.size();
        -:  126:}
        -:  127:
        -:  128:// 7. Warehouse implementation
function _ZN10minimarket8products9WarehouseC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_d called 1 returned 100% blocks executed 50%
function _ZN10minimarket8products9WarehouseC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_d called 1 returned 100% blocks executed 100%
        2:  129:Warehouse::Warehouse(const std::string& id, const std::string& loc, double cap)
        2:  130:    : warehouseId(id), location(loc), capacity(cap), usedSpace(0.0) {}
branch  0 taken 100%
branch  1 taken 0%
        -:  131:
function _ZN10minimarket8products9Warehouse13allocateSpaceEd called 2 returned 100% blocks executed 100%
        2:  132:bool Warehouse::allocateSpace(double requiredSpace) {
        2:  133:    if (requiredSpace <= 0 || usedSpace + requiredSpace > capacity) return false;
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 50%
branch  3 taken 50%
        1:  134:    usedSpace += requiredSpace;
        1:  135:    return true;
        2:  136:}
        -:  137:
function _ZNK10minimarket8products9Warehouse23calculateAvailableSpaceEv called 3 returned 100% blocks executed 100%
        3:  138:double Warehouse::calculateAvailableSpace() const {
        3:  139:    return capacity - usedSpace;
        -:  140:}
        -:  141:
function _ZNK10minimarket8products9Warehouse15canStoreProductEd called 2 returned 100% blocks executed 100%
        2:  142:bool Warehouse::canStoreProduct(double productVolume) const {
        2:  143:    return productVolume > 0 && productVolume <= calculateAvailableSpace();
branch  0 taken 0%
branch  1 taken 100%
        -:  144:}
        -:  145:
        -:  146:// 8. BarcodeSystem implementation
function _ZN10minimarket8products13BarcodeSystemC2Ev called 1 returned 100% blocks executed 58%
function _ZN10minimarket8products13BarcodeSystemC1Ev called 1 returned 100% blocks executed 100%
        2:  147:BarcodeSystem::BarcodeSystem() {
        -:  148:    // Инициализация тестовыми данными
        1:  149:    barcodeDatabase["123456789012"] = "PROD001";
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 100%
branch  5 taken 0%
        1:  150:    barcodeDatabase["987654321098"] = "PROD002";
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 100%
branch  5 taken 0%
        2:  151:}
        -:  152:
function _ZN10minimarket8products13BarcodeSystem15registerBarcodeERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 3 returned 100% blocks executed 100%
        3:  153:bool BarcodeSystem::registerBarcode(const std::string& productId, const std::string& barcode) {
        3:  154:    if (productId.empty() || barcode.empty() || barcode.length() != 12) return false;
branch  0 taken 67%
branch  1 taken 33%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 50%
branch  5 taken 50%
        1:  155:    barcodeDatabase[barcode] = productId;
        1:  156:    return true;
        3:  157:}
        -:  158:
function _ZNK10minimarket8products13BarcodeSystem20findProductByBarcodeERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 2 returned 100% blocks executed 100%
        2:  159:std::string BarcodeSystem::findProductByBarcode(const std::string& barcode) const {
        2:  160:    auto it = barcodeDatabase.find(barcode);
        2:  161:    return it != barcodeDatabase.end() ? it->second : "";
branch  0 taken 50%
branch  1 taken 50%
        -:  162:}
        -:  163:
function _ZNK10minimarket8products13BarcodeSystem15validateBarcodeERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 3 returned 100% blocks executed 100%
        3:  164:bool BarcodeSystem::validateBarcode(const std::string& barcode) const {
        3:  165:    if (barcode.length() != 12) return false;
branch  0 taken 33%
branch  1 taken 67%
       25:  166:    for (char c : barcode) {
branch  0 taken 96%
branch  1 taken 4%
       24:  167:        if (!std::isdigit(c)) return false;
branch  0 taken 4%
branch  1 taken 96%
        -:  168:    }
        1:  169:    return true;
        3:  170:}
        -:  171:
        -:  172:// 9. ProductReview implementation
function _ZN10minimarket8products13ProductReviewC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_iSA_ called 5 returned 100% blocks executed 42%
function _ZN10minimarket8products13ProductReviewC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_iSA_ called 5 returned 100% blocks executed 100%
       10:  173:ProductReview::ProductReview(const std::string& id, const std::string& prodId, int rate, const std::string& cmt)
       10:  174:    : reviewId(id), productId(prodId), rating(rate), comment(cmt) {}
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 0%
branch  3 taken 100%
        -:  175:
function _ZNK10minimarket8products13ProductReview14validateRatingEv called 5 returned 100% blocks executed 100%
        5:  176:bool ProductReview::validateRating() const {
        5:  177:    return rating >= 1 && rating <= 5;
branch  0 taken 20%
branch  1 taken 80%
        -:  178:}
        -:  179:
function _ZNK10minimarket8products13ProductReview21calculateReviewImpactEv called 1 returned 100% blocks executed 100%
        1:  180:double ProductReview::calculateReviewImpact() const {
        1:  181:    return rating * 0.2; // Влияние на рейтинг товара
        -:  182:}
        -:  183:
function _ZNK10minimarket8products13ProductReview15generateSummaryEv called 1 returned 100% blocks executed 37%
        1:  184:std::string ProductReview::generateSummary() const {
        1:  185:    return "Rating: " + std::to_string(rating) + "/5 - " + comment.substr(0, 50) + "...";
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 100%
branch  5 taken 0%
branch  6 taken 100%
branch  7 taken 0%
branch  8 taken 0%
branch  9 taken 100%
    #####:  186:}
        -:  187:
        -:  188:// 10. ProductSpecification implementation
function _ZN10minimarket8products20ProductSpecificationC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 1 returned 100% blocks executed 100%
function _ZN10minimarket8products20ProductSpecificationC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 1 returned 100% blocks executed 100%
        2:  189:ProductSpecification::ProductSpecification(const std::string& id) : productId(id) {}
        -:  190:
function _ZN10minimarket8products20ProductSpecification16addSpecificationERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 4 returned 100% blocks executed 100%
        4:  191:bool ProductSpecification::addSpecification(const std::string& key, const std::string& value) {
        4:  192:    if (key.empty() || value.empty()) return false;
branch  0 taken 75%
branch  1 taken 25%
branch  2 taken 33%
branch  3 taken 67%
        2:  193:    specifications[key] = value;
        2:  194:    return true;
        4:  195:}
        -:  196:
function _ZNK10minimarket8products20ProductSpecification16getSpecificationERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 2 returned 100% blocks executed 100%
        2:  197:std::string ProductSpecification::getSpecification(const std::string& key) const {
        2:  198:    auto it = specifications.find(key);
        2:  199:    return it != specifications.end() ? it->second : "";
branch  0 taken 50%
branch  1 taken 50%
        -:  200:}
        -:  201:
function _ZNK10minimarket8products20ProductSpecification17meetsRequirementsERKNSt3__13mapINS2_12basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEES9_NS2_4lessIS9_EENS7_INS2_4pairIKS9_S9_EEEEEE called 2 returned 100% blocks executed 100%
        2:  202:bool ProductSpecification::meetsRequirements(const std::map<std::string, std::string>& requirements) const {
        4:  203:    for (const auto& [key, requiredValue] : requirements) {
branch  0 taken 75%
branch  1 taken 25%
        6:  204:        auto it = specifications.find(key);
        3:  205:        if (it == specifications.end() || it->second != requiredValue) {
branch  0 taken 0%
branch  1 taken 100%
branch  2 taken 33%
branch  3 taken 67%
        1:  206:            return false;
        -:  207:        }
        -:  208:    }
        1:  209:    return true;
        2:  210:}
        -:  211:
        -:  212:} // namespace products
        -:  213:} // namespace minimarket
