        -:    0:Source:/Users/glebmitko/Desktop/lab1_minimarket/src/products/ProductManagement.cpp
        -:    0:Graph:CMakeFiles/run_tests.dir/src/products/ProductManagement.cpp.gcno
        -:    0:Data:CMakeFiles/run_tests.dir/src/products/ProductManagement.cpp.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:#include "../../include/products/ProductManagement.hpp"
        -:    2:#include "../../include/utils/Exceptions.hpp"
        -:    3:#include <algorithm>
        -:    4:#include <cmath>
        -:    5:
        -:    6:namespace minimarket {
        -:    7:namespace products {
        -:    8:
        -:    9:// 1. Product implementation
function _ZN10minimarket8products7ProductC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_d called 18 returned 100% blocks executed 73%
function _ZN10minimarket8products7ProductC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_d called 18 returned 100% blocks executed 100%
       36:   10:Product::Product(const std::string& id, const std::string& name, double price)
       36:   11:    : productId(id), productName(name), basePrice(price) {
branch  0 taken 18
branch  1 taken 0
       18:   12:    if (price < 0) throw exceptions::InvalidOperationException("Price cannot be negative");
branch  0 taken 16
branch  1 taken 2
branch  2 taken 2
branch  3 taken 0
branch  4 taken 2
branch  5 taken 0
branch  6 taken 0
branch  7 taken 2
branch  8 taken 0
branch  9 taken 2
       38:   13:}
        -:   14:
function _ZNK10minimarket8products7Product19calculateFinalPriceEv called 14 returned 100% blocks executed 100%
       14:   15:double Product::calculateFinalPrice() const {
       14:   16:    return basePrice * 1.2; // 20% налог
        -:   17:}
        -:   18:
function _ZN10minimarket8products7Product13applyDiscountEd called 6 returned 100% blocks executed 100%
        6:   19:bool Product::applyDiscount(double discountPercent) {
        6:   20:    if (discountPercent < 0 || discountPercent > 100) return false;
branch  0 taken 4
branch  1 taken 2
branch  2 taken 2
branch  3 taken 2
        2:   21:    basePrice *= (1 - discountPercent / 100);
        2:   22:    return true;
        6:   23:}
        -:   24:
function _ZNK10minimarket8products7Product14getProductInfoEv called 6 returned 100% blocks executed 38%
        6:   25:std::string Product::getProductInfo() const {
        6:   26:    return productName + " (ID: " + productId + ") - $" + std::to_string(basePrice);
branch  0 taken 6
branch  1 taken 0
branch  2 taken 6
branch  3 taken 0
branch  4 taken 6
branch  5 taken 0
branch  6 taken 0
branch  7 taken 6
    #####:   27:}
        -:   28:
        -:   29:// 2. Category implementation
function _ZN10minimarket8products8CategoryC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 8 returned 100% blocks executed 50%
function _ZN10minimarket8products8CategoryC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 8 returned 100% blocks executed 100%
       16:   30:Category::Category(const std::string& id, const std::string& name)
       16:   31:    : categoryId(id), categoryName(name) {}
branch  0 taken 8
branch  1 taken 0
        -:   32:
function _ZN10minimarket8products8Category10addProductERKNSt3__110shared_ptrINS0_7ProductEEE called 12 returned 100% blocks executed 75%
       12:   33:bool Category::addProduct(const std::shared_ptr<Product>& product) {
       12:   34:    if (!product) return false;
branch  0 taken 0
branch  1 taken 12
       12:   35:    products.push_back(product);
       12:   36:    return true;
       12:   37:}
        -:   38:
function _ZNK10minimarket8products8Category24calculateCategoryRevenueEv called 8 returned 100% blocks executed 100%
        8:   39:double Category::calculateCategoryRevenue() const {
        8:   40:    double total = 0.0;
       20:   41:    for (const auto& product : products) {
branch  0 taken 12
branch  1 taken 8
       12:   42:        total += product->calculateFinalPrice();
        -:   43:    }
        8:   44:    return total;
        -:   45:}
        -:   46:
function _ZNK10minimarket8products8Category15getProductNamesEv called 4 returned 100% blocks executed 61%
        4:   47:std::vector<std::string> Category::getProductNames() const {
        4:   48:    std::vector<std::string> names;
        8:   49:    for (const auto& product : products) {
branch  0 taken 4
branch  1 taken 4
        4:   50:        names.push_back(product->getProductInfo());
branch  0 taken 4
branch  1 taken 0
branch  2 taken 4
branch  3 taken 0
        -:   51:    }
        4:   52:    return names;
        4:   53:}
branch  0 taken 4
branch  1 taken 0
        -:   54:
        -:   55:// 3. Inventory implementation
function _ZN10minimarket8products9InventoryC2Ei called 6 returned 100% blocks executed 100%
function _ZN10minimarket8products9InventoryC1Ei called 6 returned 100% blocks executed 100%
       12:   56:Inventory::Inventory(int threshold) : lowStockThreshold(threshold) {}
        -:   57:
function _ZN10minimarket8products9Inventory11updateStockERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEEi called 16 returned 100% blocks executed 75%
       16:   58:bool Inventory::updateStock(const std::string& productId, int quantity) {
       16:   59:    if (productId.empty()) return false;
branch  0 taken 0
branch  1 taken 16
       16:   60:    stockLevels[productId] += quantity;
       16:   61:    return true;
       16:   62:}
        -:   63:
function _ZNK10minimarket8products9Inventory17checkAvailabilityERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEEi called 6 returned 100% blocks executed 100%
        6:   64:bool Inventory::checkAvailability(const std::string& productId, int requested) const {
        6:   65:    auto it = stockLevels.find(productId);
        6:   66:    if (it == stockLevels.end()) return false;
branch  0 taken 2
branch  1 taken 4
        4:   67:    return it->second >= requested;
        6:   68:}
        -:   69:
function _ZNK10minimarket8products9Inventory19getLowStockProductsEv called 6 returned 100% blocks executed 80%
        6:   70:std::vector<std::string> Inventory::getLowStockProducts() const {
        6:   71:    std::vector<std::string> lowStock;
       22:   72:    for (const auto& [productId, quantity] : stockLevels) {
branch  0 taken 22
branch  1 taken 0
branch  2 taken 16
branch  3 taken 6
branch  4 taken 16
branch  5 taken 0
branch  6 taken 16
branch  7 taken 0
       16:   73:        if (quantity <= lowStockThreshold) {
branch  0 taken 10
branch  1 taken 6
       10:   74:            lowStock.push_back(productId);
branch  0 taken 10
branch  1 taken 0
       10:   75:        }
        -:   76:    }
        6:   77:    return lowStock;
        6:   78:}
branch  0 taken 6
branch  1 taken 0
        -:   79:
        -:   80:// 4. PricingStrategy implementation
function _ZN10minimarket8products15PricingStrategyC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEEd called 2 returned 100% blocks executed 100%
function _ZN10minimarket8products15PricingStrategyC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEEd called 2 returned 100% blocks executed 100%
        4:   81:PricingStrategy::PricingStrategy(const std::string& type, double markup)
        4:   82:    : strategyType(type), markupPercentage(markup) {}
        -:   83:
function _ZNK10minimarket8products15PricingStrategy12applyPricingEd called 2 returned 100% blocks executed 100%
        2:   84:double PricingStrategy::applyPricing(double costPrice) const {
        2:   85:    return costPrice * (1 + markupPercentage / 100);
        -:   86:}
        -:   87:
function _ZNK10minimarket8products15PricingStrategy15validatePricingEdd called 6 returned 100% blocks executed 100%
        6:   88:bool PricingStrategy::validatePricing(double cost, double selling) const {
        6:   89:    return selling >= cost && selling <= cost * 3; // Максимум 300% наценки
branch  0 taken 2
branch  1 taken 4
        -:   90:}
        -:   91:
        -:   92:// 5. DiscountSystem implementation
function _ZN10minimarket8products14DiscountSystemC2Ed called 4 returned 100% blocks executed 100%
function _ZN10minimarket8products14DiscountSystemC1Ed called 4 returned 100% blocks executed 100%
        8:   93:DiscountSystem::DiscountSystem(double loyaltyRate) : loyaltyDiscountRate(loyaltyRate) {}
        -:   94:
function _ZN10minimarket8products14DiscountSystem20applyProductDiscountERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEEd called 6 returned 100% blocks executed 100%
        6:   95:bool DiscountSystem::applyProductDiscount(const std::string& productId, double discount) {
        6:   96:    if (discount < 0 || discount > 50) return false; // Максимум 50% скидка
branch  0 taken 6
branch  1 taken 0
branch  2 taken 2
branch  3 taken 4
        4:   97:    activeDiscounts[productId] = discount;
        4:   98:    return true;
        6:   99:}
        -:  100:
function _ZNK10minimarket8products14DiscountSystem24calculateLoyaltyDiscountEd called 2 returned 100% blocks executed 100%
        2:  101:double DiscountSystem::calculateLoyaltyDiscount(double totalAmount) const {
        2:  102:    return totalAmount * (loyaltyDiscountRate / 100);
        -:  103:}
        -:  104:
function _ZNK10minimarket8products14DiscountSystem15isDiscountValidERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 6 returned 100% blocks executed 100%
        6:  105:bool DiscountSystem::isDiscountValid(const std::string& productId) const {
        6:  106:    auto it = activeDiscounts.find(productId);
        6:  107:    return it != activeDiscounts.end() && it->second > 0;
branch  0 taken 2
branch  1 taken 4
        -:  108:}
        -:  109:
        -:  110:// 6. Supplier implementation
function _ZN10minimarket8products8SupplierC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 2 returned 100% blocks executed 50%
function _ZN10minimarket8products8SupplierC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 2 returned 100% blocks executed 100%
        4:  111:Supplier::Supplier(const std::string& id, const std::string& name)
        4:  112:    : supplierId(id), supplierName(name) {}
branch  0 taken 2
branch  1 taken 0
        -:  113:
function _ZN10minimarket8products8Supplier18addSuppliedProductERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 6 returned 100% blocks executed 100%
        6:  114:bool Supplier::addSuppliedProduct(const std::string& productId) {
        6:  115:    if (productId.empty()) return false;
branch  0 taken 2
branch  1 taken 4
        4:  116:    suppliedProducts.push_back(productId);
        4:  117:    return true;
        6:  118:}
        -:  119:
function _ZNK10minimarket8products8Supplier16canSupplyProductERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 4 returned 100% blocks executed 100%
        4:  120:bool Supplier::canSupplyProduct(const std::string& productId) const {
        4:  121:    return std::find(suppliedProducts.begin(), suppliedProducts.end(), productId) != suppliedProducts.end();
        -:  122:}
        -:  123:
function _ZNK10minimarket8products8Supplier24getSuppliedProductsCountEv called 2 returned 100% blocks executed 100%
        2:  124:int Supplier::getSuppliedProductsCount() const {
        2:  125:    return suppliedProducts.size();
        -:  126:}
        -:  127:
        -:  128:// 7. Warehouse implementation
function _ZN10minimarket8products9WarehouseC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_d called 2 returned 100% blocks executed 50%
function _ZN10minimarket8products9WarehouseC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_d called 2 returned 100% blocks executed 100%
        4:  129:Warehouse::Warehouse(const std::string& id, const std::string& loc, double cap)
        4:  130:    : warehouseId(id), location(loc), capacity(cap), usedSpace(0.0) {}
branch  0 taken 2
branch  1 taken 0
        -:  131:
function _ZN10minimarket8products9Warehouse13allocateSpaceEd called 4 returned 100% blocks executed 100%
        4:  132:bool Warehouse::allocateSpace(double requiredSpace) {
        4:  133:    if (requiredSpace <= 0 || usedSpace + requiredSpace > capacity) return false;
branch  0 taken 4
branch  1 taken 0
branch  2 taken 2
branch  3 taken 2
        2:  134:    usedSpace += requiredSpace;
        2:  135:    return true;
        4:  136:}
        -:  137:
function _ZNK10minimarket8products9Warehouse23calculateAvailableSpaceEv called 6 returned 100% blocks executed 100%
        6:  138:double Warehouse::calculateAvailableSpace() const {
        6:  139:    return capacity - usedSpace;
        -:  140:}
        -:  141:
function _ZNK10minimarket8products9Warehouse15canStoreProductEd called 4 returned 100% blocks executed 100%
        4:  142:bool Warehouse::canStoreProduct(double productVolume) const {
        4:  143:    return productVolume > 0 && productVolume <= calculateAvailableSpace();
branch  0 taken 0
branch  1 taken 4
        -:  144:}
        -:  145:
        -:  146:// 8. BarcodeSystem implementation
function _ZN10minimarket8products13BarcodeSystemC2Ev called 2 returned 100% blocks executed 58%
function _ZN10minimarket8products13BarcodeSystemC1Ev called 2 returned 100% blocks executed 100%
        4:  147:BarcodeSystem::BarcodeSystem() {
        -:  148:    // Инициализация тестовыми данными
        2:  149:    barcodeDatabase["123456789012"] = "PROD001";
branch  0 taken 2
branch  1 taken 0
branch  2 taken 2
branch  3 taken 0
branch  4 taken 2
branch  5 taken 0
        2:  150:    barcodeDatabase["987654321098"] = "PROD002";
branch  0 taken 2
branch  1 taken 0
branch  2 taken 2
branch  3 taken 0
branch  4 taken 2
branch  5 taken 0
        4:  151:}
        -:  152:
function _ZN10minimarket8products13BarcodeSystem15registerBarcodeERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 6 returned 100% blocks executed 100%
        6:  153:bool BarcodeSystem::registerBarcode(const std::string& productId, const std::string& barcode) {
        6:  154:    if (productId.empty() || barcode.empty() || barcode.length() != 12) return false;
branch  0 taken 4
branch  1 taken 2
branch  2 taken 4
branch  3 taken 0
branch  4 taken 2
branch  5 taken 2
        2:  155:    barcodeDatabase[barcode] = productId;
        2:  156:    return true;
        6:  157:}
        -:  158:
function _ZNK10minimarket8products13BarcodeSystem20findProductByBarcodeERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 4 returned 100% blocks executed 100%
        4:  159:std::string BarcodeSystem::findProductByBarcode(const std::string& barcode) const {
        4:  160:    auto it = barcodeDatabase.find(barcode);
        4:  161:    return it != barcodeDatabase.end() ? it->second : "";
branch  0 taken 2
branch  1 taken 2
        -:  162:}
        -:  163:
function _ZNK10minimarket8products13BarcodeSystem15validateBarcodeERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 6 returned 100% blocks executed 100%
        6:  164:bool BarcodeSystem::validateBarcode(const std::string& barcode) const {
        6:  165:    if (barcode.length() != 12) return false;
branch  0 taken 2
branch  1 taken 4
       50:  166:    for (char c : barcode) {
branch  0 taken 48
branch  1 taken 2
       48:  167:        if (!std::isdigit(c)) return false;
branch  0 taken 2
branch  1 taken 46
        -:  168:    }
        2:  169:    return true;
        6:  170:}
        -:  171:
        -:  172:// 9. ProductReview implementation
function _ZN10minimarket8products13ProductReviewC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_iSA_ called 10 returned 100% blocks executed 42%
function _ZN10minimarket8products13ProductReviewC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_iSA_ called 10 returned 100% blocks executed 100%
       20:  173:ProductReview::ProductReview(const std::string& id, const std::string& prodId, int rate, const std::string& cmt)
       20:  174:    : reviewId(id), productId(prodId), rating(rate), comment(cmt) {}
branch  0 taken 10
branch  1 taken 0
branch  2 taken 0
branch  3 taken 10
        -:  175:
function _ZNK10minimarket8products13ProductReview14validateRatingEv called 10 returned 100% blocks executed 100%
       10:  176:bool ProductReview::validateRating() const {
       10:  177:    return rating >= 1 && rating <= 5;
branch  0 taken 2
branch  1 taken 8
        -:  178:}
        -:  179:
function _ZNK10minimarket8products13ProductReview21calculateReviewImpactEv called 2 returned 100% blocks executed 100%
        2:  180:double ProductReview::calculateReviewImpact() const {
        2:  181:    return rating * 0.2; // Влияние на рейтинг товара
        -:  182:}
        -:  183:
function _ZNK10minimarket8products13ProductReview15generateSummaryEv called 2 returned 100% blocks executed 37%
        2:  184:std::string ProductReview::generateSummary() const {
        2:  185:    return "Rating: " + std::to_string(rating) + "/5 - " + comment.substr(0, 50) + "...";
branch  0 taken 2
branch  1 taken 0
branch  2 taken 2
branch  3 taken 0
branch  4 taken 2
branch  5 taken 0
branch  6 taken 2
branch  7 taken 0
branch  8 taken 0
branch  9 taken 2
    #####:  186:}
        -:  187:
        -:  188:// 10. ProductSpecification implementation
function _ZN10minimarket8products20ProductSpecificationC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 2 returned 100% blocks executed 100%
function _ZN10minimarket8products20ProductSpecificationC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 2 returned 100% blocks executed 100%
        4:  189:ProductSpecification::ProductSpecification(const std::string& id) : productId(id) {}
        -:  190:
function _ZN10minimarket8products20ProductSpecification16addSpecificationERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEESA_ called 8 returned 100% blocks executed 100%
        8:  191:bool ProductSpecification::addSpecification(const std::string& key, const std::string& value) {
        8:  192:    if (key.empty() || value.empty()) return false;
branch  0 taken 6
branch  1 taken 2
branch  2 taken 2
branch  3 taken 4
        4:  193:    specifications[key] = value;
        4:  194:    return true;
        8:  195:}
        -:  196:
function _ZNK10minimarket8products20ProductSpecification16getSpecificationERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE called 4 returned 100% blocks executed 100%
        4:  197:std::string ProductSpecification::getSpecification(const std::string& key) const {
        4:  198:    auto it = specifications.find(key);
        4:  199:    return it != specifications.end() ? it->second : "";
branch  0 taken 2
branch  1 taken 2
        -:  200:}
        -:  201:
function _ZNK10minimarket8products20ProductSpecification17meetsRequirementsERKNSt3__13mapINS2_12basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEES9_NS2_4lessIS9_EENS7_INS2_4pairIKS9_S9_EEEEEE called 4 returned 100% blocks executed 100%
        4:  202:bool ProductSpecification::meetsRequirements(const std::map<std::string, std::string>& requirements) const {
        8:  203:    for (const auto& [key, requiredValue] : requirements) {
branch  0 taken 6
branch  1 taken 2
       12:  204:        auto it = specifications.find(key);
        6:  205:        if (it == specifications.end() || it->second != requiredValue) {
branch  0 taken 0
branch  1 taken 6
branch  2 taken 2
branch  3 taken 4
        2:  206:            return false;
        -:  207:        }
        -:  208:    }
        2:  209:    return true;
        4:  210:}
        -:  211:
        -:  212:} // namespace products
        -:  213:} // namespace minimarket
